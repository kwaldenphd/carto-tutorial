# Carto Tutorial

This tutorial was written by <a href="https://www.grinnell.edu/users/waldenka">Katherine Walden</a> (Digital Liberal Arts Specialist, Grinnell College). The tutorial framework was created by Sarah Purcell (L.F. Parker Professor of History, Grinnell College) and Sophia Gates Stern, student mentor for the class.

This tutorial was reviewed by <a href="https://www.grinnell.edu/users/donovang">Gina Donovan</a> (Instructional Technologist, Grinnell College) and Lauren Frankel and Martin Toney, student workers in Grinnell College’s <a href="http://dasil.sites.grinnell.edu/">Data Analysis and Social Inquiry Lab</a>.

This tutorial uses <a href="http://www.cameronblevins.org/postal-data/">data generated by Cameron Blevins</a> and posted on his personal site.

<a href="http://creativecommons.org/licenses/by-nc/4.0/" rel="license"><img style="border-width: 0;" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" alt="Creative Commons License" /></a>
Introduction to Mapping Part I (Carto) is licensed under a <a href="http://creativecommons.org/licenses/by-nc/4.0/" rel="license">Creative Commons Attribution-NonCommercial 4.0 International License</a>.

<hr />

Historians have long used spatial analysis, but digital mapping tools have made it possible for historians to explore larger and more complex spatial data sets. Northeastern University historian Cameron Blevins does this in his research on the relationship between state formation, westward expansion, and the U.S. postal service. In this tutorial, we will be using some of the data sets from Blevins’s research to learn more about some of the digital spatial analysis and visualization tools used in historical research.

<hr />

## How Blevins describes his research (from<a href="http://www.cameronblevins.org/research/"> his personal site</a>):

<em>My current project is a spatial history of two of the defining projects of the late nineteenth-century United States: state formation and western expansion. Between the 1860s and the 1890s, the western United States underwent one of the most dramatic reorganizations of people, land, capital, and resources in American history. How did this happen so quickly, and across such a large and inhospitable area? Why were so many people willing and able to move to such shockingly remote places? How did the American state consolidate its control over this vast territory? I argue that the sprawling infrastructure of the U.S. Post holds the key to understanding the speed and scale of western expansion. Gossamer Network uses a database of more than 100,000 post offices <a href="http://cameronblevins.org/gotp">to map the spread of the postal network in the western United States</a>. This presents one of the most comprehensive and detailed spatial renderings of the nineteenth-century state that has ever been assembled.</em>

<em>This analysis leads to a series of new interpretations about the American state and the West. The U.S. Post was the era’s most spatially expansive institution. No other network, public or private, connected so many different people in so many different places across such a large area. It did so by operating what I’ve termed a “gossamer network.” The U.S. Post expanded across space by grafting the public functions of mail service onto the existing operations of private businesses: contracting with a stagecoach company to transport bags of mail, or paying a local businessman to periodically distribute letters from his general store. This flexible, ethereal structure allowed the U.S. Post to expand and contract across remote areas with a stunning speed. Its ability to move in lockstep with Anglo-Americans had enormous consequences for the West, accelerating a pattern of imperial conquest and settler colonialism while serving as the underlying machinery of governance in the region. Gossamer Network sheds new light on the familiar subject of western expansion and forces us to reconsider the very nature of state power during this era.</em>

<hr />

## Preliminary reflection questions:
<ul>
 	<li>What are Blevins’s research questions?</li>
 	<li>Why (and how) is spatial analysis important to addressing those questions?</li>
 	<li>What types of data do you think Blevins might work with for this project?</li>
 	<li>Do you see any potential challenges or limitations in using spatial data as the foundation for this project?</li>
</ul>

<hr />

## Data

1-Download the 1870_Federal_Census_Grinnell_Township.csv file from this GitHub repo. Save the 1870 Federal Census Grinnell Township file to your Desktop.  

Alternatively, you can go to the <a href="http://www.cameronblevins.org/postal-data/">data page</a> of Blevins’s personal site. Under the “Regional Data: Western Post Offices and Postmaster Salaries” heading, download the <strong>1871_PostmasterSalaries CSV file</strong>.

2-Open the file in Microsoft Excel.

3-What fields are represented in the data? What questions do you have about the data?

4-Compare the <a href="https://babel.hathitrust.org/cgi/pt?id=loc.ark:/13960/t3kw65n8k;view=1up;seq=7">original data source</a> and what you see in the Excel table—what differences do you observe in how the data is represented? What types of questions do you think this data might be able to address? What gaps or absences do you notice in the data?

5-Save the file to your <strong>Desktop</strong> as a <strong>CSV</strong>. If Excel displays a warning message when you try to save as a CSV, click <strong>OK</strong> and continue.

<hr />

<blockquote>A note on geocoding:

The process of adding spatial information to data or determining exact coordinates for locations is called geocoding. As you notice in Blevins’s data, the original data source does not include specific geocordinates for every post office location. Historically, gazetteer publications (essentially a phone book with locations and geocoordinates) were used to find place information for spatial data. Best practice for limited data sets is still to use a gazetteer to georeferenced spatial data, and the internet has increased the availability and searchability of gazetteers. However, manual geocoding is not feasible for many larger data sets. A variety of free and paid services offer automated geocoding.</blockquote>

<hr />

## The United States in 1871

One of the challenges in historical spatial analysis is maps, boundaries, and territories change over time. A map of the United States in 1800 looks very different than what we encounter in Google Maps or MapQuest. Explore <a href="https://www.davidrumsey.com/luna/servlet/detail/RUMSEY~8~1~26362~1100036:United-States-&amp;-territories-?sort=Pub_List_No_InitialSort%2CPub_Date%2CPub_List_No%2CSeries_No">a map of the U.S.</a> that was drawn and published in 1871. Not all territories drawn on the map had been granted statehood in 1871. Consult a <a href="https://en.wikipedia.org/wiki/List_of_U.S._states_by_date_of_admission_to_the_Union">chronological list of U.S. states by date of admission to the Union</a> to see what territories on the map would not have been recognized states in 1871.

### Reflection questions:
<ul>
 	<li>Why do you think it is important to understand the historical spatial context for Blevins’s data?  What all do we know about context?</li>
 	<li>How would something like knowing states’ dates of admission to the Union impact how we analyze spatial data?</li>
 	<li>What features on the 1871 map stand out as significant?</li>
</ul>

<hr />

## Carto

<a href="https://carto.com/">Carto</a> is a cloud-computing platform released in 2011 by developer Vizzuality. Written in Ruby and Javascript, Carto is designed to allow businesses to analyze and visualize spatial data without prior or detailed technical GIS knowledge. As we’ll learn in another tutorial, GIS programs like ArcGIS are not always intuitive and user-friendly. Carto was designed as an alternative, with a web-hosted option that doesn’t require a local installation, although Carto is available as <a href="https://github.com/CartoDB/CartoDB">open source software</a>. The short version—users can work with Carto in the browser without needing to set up their own server to host the program. The web-based version of Carto is considered a <a href="https://carto.com/pricing/">“freemium” software</a>—free for some types of users with limited web-based functionality with scaled pricing plans for long-term use. Anyone can register for a 30 day Carto trial, which is what we will be using in this tutorial.

<hr />

6-If you do not already have a Carto account, <a href="https://carto.com/signup/">register</a> for a free 30 day trial. No billing and payment information is required to sign up.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_1.PNG?raw=true"><img class="aligncenter size-large wp-image-461" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_1.PNG?raw=true" alt="" width="676" height="335" /></a></p>

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_2.PNG?raw=true"><img class="aligncenter size-full wp-image-462" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_2.PNG?raw=true" alt="" width="424" height="211" /></a></p>

7-<strong>Log in</strong> to Carto. Next to your name in the top menu is a <strong>Maps</strong> icon with a dropdown arrow. Select <strong>Your datasets</strong> from the dropdown.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_3.PNG?raw=true"><img class="aligncenter size-full wp-image-463" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_3.PNG?raw=true" alt="" width="381" height="77" /></a></p>

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_4.PNG?raw=true"><img class="aligncenter size-large wp-image-464" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_4.PNG?raw=true" alt="" width="676" height="549" /></a></p>

8-Click on the <strong>New Dataset</strong> icon in the upper right-hand corner of the page.

9-You can browse to select the <strong>1871_PostmasterSalary CSV file</strong> from your <strong>Desktop</strong>, or drag and drop it into the upload section of the page.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_5.PNG?raw=true"><img class="aligncenter size-full wp-image-465" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_5.PNG?raw=true" alt="" width="273" height="98" /></a></p>

10-Click the <strong>Connect Dataset</strong> blue icon in the bottom right-hand corner of the page to upload the dataset to Carto.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_6.PNG?raw=true"><img class="aligncenter size-large wp-image-466" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_6.PNG?raw=true" alt="" width="676" height="329" /></a></p>

11-Once your data has been added to Carto, compare how the data was structured in Excel versus how it is structured and described in Carto. What similarities do you notice? What has changed? Why do you think Carto made these changes or added this additional information?

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_7.PNG?raw=true"><img class="aligncenter size-full wp-image-467" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_7.PNG?raw=true" alt="" width="181" height="78" /></a></p>

12-Click the blue <strong>Create Map</strong> icon in the bottom right-hand corner of the page.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_8.PNG?raw=true"><img class="aligncenter size-large wp-image-468" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_8.PNG?raw=true" alt="" width="676" height="331" /></a></p>

13-Once you’ve created a map, you move into Carto’s <strong>builder environment</strong>. Use the four-step tour to learn more about Carto’s map editing page.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_13.PNG?raw=true"><img class="aligncenter size-full wp-image-450" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_13.PNG?raw=true" alt="" width="347" height="398" /></a></p>

14-<strong>Rename the map</strong> by clicking on the three vertical dots next to the <strong>table_1871_postmas… header</strong>. Click <strong>Rename</strong> and change your map’s title to “Postmaster Salaries” or another descriptive phrase. You can also rename the map by double-clicking the title.

15-Let’s explore the map editing page. Use the plus or minus symbols in the bottom left-hand corner of the map to zoom in and out on the map. Double-clicking an area or using your mouse scroll wheel are also ways to zoom in and out.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_11.PNG?raw=true"><img class="aligncenter size-full wp-image-471" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_11.PNG?raw=true" alt="" width="324" height="307" /></a></p>

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_12.PNG?raw=true"><img class="aligncenter size-full wp-image-449" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_12.PNG?raw=true" alt="" width="346" height="947" /></a></p>

16-Click on any map point and click on the small light blue pencil icon that appears. Clicking this editing icon shows you that point’s attributes, such as its latitude, longitude, and other descriptive information. If needed, you could edit point data on this screen.

17-To exit looking at data points, click the <strong>Back</strong> arrow in the top left-hand corner of the page.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_10.PNG?raw=true"><img class="aligncenter size-full wp-image-470" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_10.PNG?raw=true" alt="" width="306" height="287" /></a></p>

18-Although we are only working with one data layer in this tutorial, many mapping projects work with multiple layers so naming data layers is a useful practice. <strong>Click on the three vertical dots</strong> next to the data set’s title. Click <strong>rename</strong> and enter an appropriate descriptive name for the data set. You can also rename the data set by double-clicking the title.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_14.PNG?raw=true"><img class="aligncenter size-full wp-image-451" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_14.PNG?raw=true" alt="" width="347" height="946" /></a></p>

19-Click on the <strong>dataset layer</strong> to move into Carto’s <strong>layer pane</strong>. Another brief tour can help you navigate the layer pane, which includes a menu with <strong>Data, Analysis, Style, Pop-Up,</strong> and <strong>Legend</strong> options.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_15.PNG?raw=true"><img class="aligncenter size-full wp-image-452" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_15.PNG?raw=true" alt="" width="332" height="222" /></a></p>

20-We’ll explore spatial analysis more in a later tutorial, but select <strong>Style</strong> from the layer menu. <strong>Aggregation</strong> offers different ways to visualize your data points on the map, from the default circular points to hexagons to heat maps and time animations. What types of aggregation are most effective for this data set? What types of aggregation do not work for this data set? What aspects of the data are highlighted in different aggregations?

21-The second option in the <strong>Style</strong> menu allows you to change the size and color of your data points. In Carto’s default settings, point size and color is standardized across all data points.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_16.PNG?raw=true"><img class="aligncenter size-full wp-image-453" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_16.PNG?raw=true" alt="" width="325" height="240" /></a></p>

22-Under <strong>Point Size</strong>, switch the selection from <strong>Fixed</strong> to <strong>By value</strong>, and select <strong>pm_salary</strong>. Sizing points by value selects a data field and sizes points based on how frequently they appear in the dataset.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_17.PNG?raw=true"><img class="aligncenter size-full wp-image-454" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_17.PNG?raw=true" alt="" width="379" height="334" /></a></p>

23-When sizing points by value, you can customize how many buckets (categories) you want to have, as well as how the distribution of those buckets is calculated. Carto’s default setting uses <strong>Quantiles</strong> to calculate bucket distribution, but you can select other ways to calculate those ranges.

24-What happens when you change the <strong>number of buckets</strong>, <strong>min/max values</strong>, or the <strong>way bucket distribution is calculated</strong>? What impact do these choices have on how your data is represented on the map? What factors would you need to consider when making these choices to accurately represent your data and analysis?

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_16.PNG?raw=true"><img class="aligncenter size-full wp-image-453" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_16.PNG?raw=true" alt="" width="325" height="240" /></a></p>

25-In addition to sizing points by value, we can also assign colors to points based on their value. Switch the <strong>Point Size</strong> selection back to <strong>Fixed</strong>, and switch the <strong>Point Color</strong> selection from <strong>Solid</strong> to <strong>By Value</strong>. Select the <strong>pm_salary</strong> value to recolor your points based on salary ranges.

26-Like with <strong>Point Size</strong>, Carto gives you the option of selecting your number of buckets and how those bucket ranges are calculated. You can also use one of Carto’s preset color palettes or build your own custom color set using a free online resource like <a href="http://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">Color Brewer</a>. Carto also gives you the option to change the size of your points (<strong>point size</strong>), the size of your point outline (<strong>stroke size</strong>) and the color of your point outline (<strong>stroke color</strong>).

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_19.PNG?raw=true"><img class="aligncenter size-full wp-image-456" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_19.PNG?raw=true" alt="" width="344" height="826" /></a></p>

27-Select the <strong>Pop-Up</strong> icon in the layer menu. Pop-Ups include data that displays when you click on a specific map point. In Carto’s default settings, no customized pop-ups appear.

28-Select <strong>Click</strong> to design the pop-up that appears when you click on a map point. Select <strong>Hover</strong> to design the pop-up that appears when you hover over a map point.

29-For <strong>Click</strong> and <strong>Hover</strong>, Carto allows you to determine the size and coloring of the pop-up window, as well as what data fields are displayed (and how they are labeled).

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_20.PNG?raw=true"><img class="aligncenter size-full wp-image-457" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_20.PNG?raw=true" alt="" width="497" height="837" /></a></p>

30-If you wanted to further customize your pop-ups, Carto provides an <strong>HTML view</strong> where you could further customize the style of text in your pop-ups.

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_8.PNG?raw=true"><img class="aligncenter size-large wp-image-468" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_8.PNG?raw=true" alt="" width="676" height="331" /></a></p>

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_21.PNG?raw=true"><img class="aligncenter size-full wp-image-458" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_21.PNG?raw-true" alt="" width="111" height="62" /></a></p>

31-Once you are satisfied with the styling of your pop-ups, click the <strong>back</strong> arrow to return to the main editing page. Because Carto is a cloud-based service, it is saving edits as you make them. However, the map project will not be published or shared until you click the <strong>Publish</strong> blue rectangular icon on the bottom left-hand side of the page.

<hr />

## Extra time?

### Making corrections to your data:

As we read in the introduction to this tutorial, this dataset includes spatial information about post offices located in the western United States. You have noticed three map points in the Mediterranean when you loaded the data into Carto. Open the editor for those data points and see what steps are needed to correctly geocode the data.

### Additional features to explore:

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_22.PNG?raw=true"><img class="size-full wp-image-459 aligncenter" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_22.PNG?raw=true" alt="" width="340" height="299" /></a></p>

<p align="center"><a href="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_23.PNG?raw-true"><img class="size-full wp-image-460 aligncenter" src="https://github.com/kwaldenphd/carto-tutorial/blob/master/screenshots/Capture_23.PNG?raw=true" alt="" width="332" height="233" /></a></p>

In this tutorial, we have been focusing on editing a data layer in Carto. The program also includes tools that let you analyze your data (<strong>Layers-&gt;Analysis</strong>) and add interactive <strong>widgets</strong> for a dynamic public interface.
